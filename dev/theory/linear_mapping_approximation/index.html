<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear Mapping Approximation · MomentClosure.jl</title><meta name="title" content="Linear Mapping Approximation · MomentClosure.jl"/><meta property="og:title" content="Linear Mapping Approximation · MomentClosure.jl"/><meta property="twitter:title" content="Linear Mapping Approximation · MomentClosure.jl"/><meta name="description" content="Documentation for MomentClosure.jl."/><meta property="og:description" content="Documentation for MomentClosure.jl."/><meta property="twitter:description" content="Documentation for MomentClosure.jl."/><meta property="og:url" content="https://augustinas1.github.io/MomentClosure.jl/theory/linear_mapping_approximation/"/><meta property="twitter:url" content="https://augustinas1.github.io/MomentClosure.jl/theory/linear_mapping_approximation/"/><link rel="canonical" href="https://augustinas1.github.io/MomentClosure.jl/theory/linear_mapping_approximation/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MomentClosure.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../moment_expansion_CME/">Moment Expansion (CME)</a></li><li><a class="tocitem" href="../moment_expansion_SDE/">Moment Expansion (SDE)</a></li><li><a class="tocitem" href="../moment_closure_approximations/">Moment Closure Approximations</a></li><li class="is-active"><a class="tocitem" href>Linear Mapping Approximation</a><ul class="internal"><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/using_momentclosure/">Using MomentClosure</a></li><li><a class="tocitem" href="../../tutorials/using_momentclosure_SDE/">Moment Equations from SDEs</a></li><li><a class="tocitem" href="../../tutorials/common_issues/">Common Issues</a></li><li><a class="tocitem" href="../../tutorials/time-dependent_propensities/">Time-dependent Propensity Functions</a></li><li><a class="tocitem" href="../../tutorials/geometric_reactions+conditional_closures/">Geometrically Distributed Reaction Products and Conditional Closures</a></li><li><a class="tocitem" href="../../tutorials/P53_system_example/">P53 System Example</a></li><li><a class="tocitem" href="../../tutorials/derivative_matching_example/">Derivative Matching Example</a></li><li><a class="tocitem" href="../../tutorials/SIR_example/">SIR Model Example</a></li><li><a class="tocitem" href="../../tutorials/LMA_example/">LMA Example</a></li><li><a class="tocitem" href="../../tutorials/parameter_estimation_SDE/">Parameter Estimation of Diffusion Processes</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../api/momentclosure_api/">MomentClosure.jl API</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li class="is-active"><a href>Linear Mapping Approximation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear Mapping Approximation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/augustinas1/MomentClosure.jl/blob/main/docs/src/theory/linear_mapping_approximation.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="linear_mapping_approximation"><a class="docs-heading-anchor" href="#linear_mapping_approximation">Linear Mapping Approximation</a><a id="linear_mapping_approximation-1"></a><a class="docs-heading-anchor-permalink" href="#linear_mapping_approximation" title="Permalink"></a></h1><p>The Linear Mapping Approximation (LMA) provides a novel way of approximating the solution of the <a href="../moment_expansion_CME/#chemical_master_equation">CME</a> and has been shown to be accurate for a variety of models of gene regulatory networks (GRNs) [1]. It is based on mapping a <em>nonlinear</em> GRN onto an equivalent <em>linear</em> GRN so that the exact solution of the linear system gives an approximate solution of the nonlinear system. The LMA is restricted in its applicability to chemical reaction networks where one of the substrates in each nonlinear reaction is a molecular species which copy number can be either zero or one (a Bernoulli/binary random variable). Note that a network can contain an arbitrary number of such species but more than one of them cannot be involved in any nonlinear reaction. Below we provide a short overview of the LMA and urge the reader to see the original <a href="https://doi.org/10.1038/s41467-018-05822-0">paper</a> for a more comprehensive description [1].</p><p>To explain the LMA procedure, we start by considering a simple example of a two-state GRN as done in a <a href="../moment_closure_approximations/#conditional_closures">previous section on conditional closures</a>, denoting the binary gene state by <span>$g$</span> and the protein number by <span>$p$</span>. We assume that there is a single nonlinear reversible reaction in the network given by</p><p class="math-container">\[\begin{align*}
G+P &amp;\underset{σ_u}{\stackrel{σ_b}{\rightleftharpoons}} G^*,
\end{align*}\]</p><p>where <span>$P$</span> denotes the protein and the gene can be in either state <span>$G$</span> (<span>$g=1$</span>) or <span>$G^*$</span> (<span>$g=0$</span>). Our aim is to find an approximate time-dependent probability distribution of protein numbers <span>$p$</span> at time <span>$t$</span>.</p><p>The steps of performing the LMA can then be described as follows:</p><p><strong>1.</strong> Find the linear network by replacing any reversible nonlinear reaction (it must involve one binary species) in the nonlinear network by a reversible pseudo first-order reaction between the binary species&#39; states.</p><ul><li>In our example, we replace the reaction above with <span>$G \underset{σ_u}{\stackrel{\bar{σ}_b}{\rightleftharpoons}} G^*$</span>, noting that the rate parameter is changed from <span>$σ_b$</span> to <span>$\bar{σ}_b$</span>. Moreover, this approach is just as applicable in case of cooperativity, e.g., <span>$G+nP \rightleftharpoons G^*$</span> (where <span>$n$</span> is an integer indicating the cooperative order) would be similarly replaced with <span>$G \rightleftharpoons G^*$</span>.</li></ul><p><strong>2.</strong> Approximate the changed rate parameters of the linearised reactions by their expectation values.</p><ul><li>As noted in [1], the first-order reaction <span>$G \stackrel{\bar{σ}_b}\rightarrow G^*$</span> maps onto the second-order reaction <span>$G+P \stackrel{σ_b}\rightarrow  G^*$</span> if we choose <span>$\bar{σ}_b = σ_b \left(p \,|\, g=1 \right)$</span>, where <span>$p \,|\, g=1$</span> indicates the instantaneous protein number given the gene is in the state <span>$G$</span>. In LMA, we use the mean-field approximation taking the expectation value of the rate so that<p class="math-container">\[\begin{align*}
\bar{σ}_b = σ_b \left \langle p \,|\, g=1 \right \rangle = σ_b \frac{\left\langle pg \right\rangle}{\left\langle g \right\rangle}.
\end{align*}\]</p>The same procedure can be extended to the general nonlinear reaction where <span>$n$</span> proteins bind cooperatively. The effective parameter is then given by<p class="math-container">\[\bar{σ}_b = σ_b \frac{\left\langle \prod_{i=0}^{n-1} \left( p-i\right)g \right\rangle}{\left\langle g \right\rangle}.\]</p></li></ul><p><strong>3.</strong> Write down the moment equations for the linear network using the approximated stochastic rates.</p><ul><li>Note that the moment equations must be generated up the order given by the highest order nonlinear reaction in the network. If the only nonlinear reaction is the second-order reaction <span>$G+P \stackrel{σ_b}\rightarrow G^*$</span>, we need to consider only moments up to the second order (as hinted by the functional form of <span>$\bar{σ}_b$</span> above). However, the moment hierarchy is otherwise closed, no additional moment closure approximations need to be performed, and therefore we can solve the moment equations in a straightforward manner.</li></ul><p><strong>4.</strong> Solve the moment equations numerically up to time <span>$t$</span> and plug the resulting moment values into the equations for the effective parameters. Proceed to calculate the time-average of these parameters over the time-interval <span>$[0, t]$</span>.</p><ul><li>In our example, plugging the solved-for moment values into the equation for <span>$\bar{σ}_b$</span> allows us to interpret the effective parameter as a time-dependent function <span>$\bar{σ}_b(t)$</span>. However, as the time-dependent probability distribution solution of the CME for the nonlinear network with a general time-dependent <span>$\bar{σ}_b$</span> is most likely intractable, we transform <span>$\bar{σ}_b(t)$</span> into a time-independent constant by taking its time-average <span>$\bar{σ}_b^* = \int_0^t \bar{σ}_b(t&#39;) dt&#39; / t$</span>. This approach is justified in [1] by considering the Magnus expansion.</li></ul><p><strong>5.</strong> Obtain the time-dependent probability distribution solution of the CME of the linear network assuming that the rate parameters of the linearised reactions are time-independent constants.</p><ul><li>Note that this step is the major limitation of the LMA as closed-form solutions are available only for a handful of systems (consult [1] for more details).</li></ul><p><strong>6.</strong> Finally, construct the approximate probability distribution of the nonlinear network at time <span>$t$</span> by replacing the respective rate parameters with their time-averaged equivalents obtained in the previous step.</p><p>MomentClosure.jl provides automated generation of the closed moment equations using LMA given a nonlinear chemical reaction network and its linear equivalent. This encapsulates the first three steps of the LMA procedure outlined above which are general and can be seen as an original moment closure approximation. We apply the LMA on simple models of nonlinear GRNs and also discuss how the subsequent LMA steps can be performed in Julia on a case-by-case basis in <a href="../../tutorials/LMA_example/#linear_mapping_approximation_example">this tutorial example</a>.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1]: Z. Cao and R. Grima, &quot;Linear mapping approximation of gene regulatory networks with stochastic dynamics&quot;, Nature Communications 9, 3305 (2018). <a href="https://doi.org/10.1038/s41467-018-05822-0">https://doi.org/10.1038/s41467-018-05822-0</a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../moment_closure_approximations/">« Moment Closure Approximations</a><a class="docs-footer-nextpage" href="../../tutorials/using_momentclosure/">Using MomentClosure »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Monday 2 June 2025 08:05">Monday 2 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
